import{N as w,H as I,r as j,i as E,k as T,l as L,j as e,t as N,P as D,e as B,F as b,m as d,d as u,o as p,p as n,b as c,R as J,W as M,I as F,B as P,n as W,a as h,q as y}from"./index-Dbp1fGsr.js";import{S as O,l as U}from"./listing.joi-DU1Wk9ll.js";function H(){const v=w(),A=I("(max-width: 700px)"),S="http://localhost:8181",[R,x]=j.useState(!1),{register:o,handleSubmit:k,control:s,formState:{errors:t,isValid:C}}=E({mode:"all",resolver:W(U),defaultValues:{companyName:"",requirements:[],advantages:[],apply:{method:"email",contact:""},location:{region:"",city:""},workArrangement:"",industry:"",isActive:!0,expiresAt:""}}),m=T({control:s,name:"location.region"}),f=j.useMemo(()=>m?L(m).map(a=>({value:a,label:a})):[],[m]),q=async a=>{const r=localStorage.getItem("token")||sessionStorage.getItem("token");h.defaults.headers.common["x-auth-token"]=r;const i=`${S}/api/listings/`,l={...a,expiresAt:a.expiresAt?new Date(a.expiresAt).toISOString():null};x(!0);try{(await h.post(i,l)).status===201&&(y.show({title:"Success",message:"Listing created!",color:"green"}),v("/my-listings"))}catch(g){y.show({title:"Error",message:`Listing creation failed! ${g?.response?.data||g.message}`,color:"red"})}finally{x(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(N,{title:"Post a Job | JobRocket",description:"Create a new job listing and reach English-speaking candidates in Israel",keywords:"post job, create listing, hire employees, job posting"}),e.jsxs(D,{children:[e.jsx(B,{ta:"center",my:10,children:"Create A Listing"}),e.jsxs("form",{onSubmit:k(q),children:[e.jsxs(b,{direction:"column",gap:10,py:10,mx:"auto",style:{width:A?"90%":"50%"},children:[e.jsxs(d,{legend:"Job Info",children:[e.jsx(u,{label:"Company Name",required:!0,...o("companyName"),error:t.companyName?.message}),e.jsx(u,{label:"Job Title",required:!0,...o("jobTitle"),error:t.jobTitle?.message}),e.jsx(p,{label:"Job Description",minRows:4,required:!0,...o("jobDescription"),error:t.jobDescription?.message}),e.jsx(n,{name:"requirements",control:s,render:({field:a})=>e.jsx(p,{label:"Requirements",placeholder:"Add one requirement per line",minRows:3,value:(a.value||[]).join(`
`),onChange:r=>{const i=r.currentTarget.value.split(`
`).map(l=>l.trim()).filter(Boolean);a.onChange(i)},error:t.requirements?.message})}),e.jsx(n,{name:"advantages",control:s,render:({field:a})=>e.jsx(p,{label:"Nice to Have",placeholder:"Add one advantage per line",minRows:3,value:(a.value||[]).join(`
`),onChange:r=>{const i=r.currentTarget.value.split(`
`).map(l=>l.trim()).filter(Boolean);a.onChange(i)},error:t.advantages?.message})})]}),e.jsxs(d,{legend:"Application",children:[e.jsx(n,{name:"apply.method",control:s,render:({field:a})=>e.jsx(c,{label:"Application Method",required:!0,data:[{value:"email",label:"Email"},{value:"link",label:"External Link"}],...a,error:t.apply?.method?.message})}),e.jsx(u,{label:"Application Contact / URL",required:!0,...o("apply.contact"),error:t.apply?.contact?.message})]}),e.jsxs(d,{legend:"Location",children:[e.jsx(n,{name:"location.region",control:s,render:({field:a})=>e.jsx(c,{label:"Region",required:!0,searchable:!0,data:J.map(r=>({value:r,label:r})),...a,error:t.location?.region?.message})}),e.jsx(n,{name:"location.city",control:s,render:({field:a})=>e.jsx(c,{label:"City",required:!0,searchable:!0,disabled:!m,data:f,...a,error:t.location?.city?.message})})]}),e.jsxs(d,{legend:"Job Details",children:[e.jsx(n,{name:"workArrangement",control:s,render:({field:a})=>e.jsx(c,{label:"Work Arrangement",required:!0,searchable:!0,data:M.map(r=>({value:r,label:r})),...a,error:t.workArrangement?.message})}),e.jsx(n,{name:"industry",control:s,render:({field:a})=>e.jsx(c,{label:"Industry",required:!0,searchable:!0,data:F.map(r=>({value:r,label:r})),...a,error:t.industry?.message})}),e.jsx(n,{name:"isActive",control:s,render:({field:a})=>e.jsx(O,{label:"Listing is active",checked:a.value,onChange:r=>a.onChange(r.currentTarget.checked)})}),e.jsx(u,{label:"Expiration Date",type:"date",...o("expiresAt"),error:t.expiresAt?.message})]})]}),e.jsx(b,{justify:"center",my:10,children:e.jsx(P,{type:"submit",size:"lg",disabled:!C,loading:R,children:"Create"})})]})]})]})}export{H as CreateListing};
