import{c as Ee,f as le,u as ne,j as e,B as Y,a as Pe,b as Oe,U as Be,g as Le,d as qe,e as $e,h as We,i as Ue,k as He,l as Je,m as Ve,n as X,o as U,r as w,M as he,T as j,G as D,p as K,q as be,s as ce,S as z,t as I,v as N,E as Ce,C as ze,A as W,w as ve,x as Ze,y as Ge,z as fe,D as Ke,F as Ye,H as De,I as te,J as Xe,K as $,L as ye,R as Qe,W as et,N as B,O as tt,P as st,Q as Z,V as we,X as at,Y as it,Z as lt,_ as nt,$ as rt,a0 as ot}from"./index-LTZHocb-.js";import{I as ie,T as c,a as Te}from"./IconTrash-C9p78AAc.js";import{c as ct}from"./getCleanedListingData-KxhxgDA4.js";import{R as se,S as dt,l as ht}from"./listing.joi-IIc8xXxE.js";import{T as G,I as ut}from"./IconUsers-C2yydGe8.js";function Se(t,a){return l=>{if(typeof l!="string"||l.trim().length===0)throw new Error(a);return`${t}-${l}`}}function de(t,a){let l=t;for(;(l=l.parentElement)&&!l.matches(a););return l}function pt(t,a,l){for(let s=t-1;s>=0;s-=1)if(!a[s].disabled)return s;if(l){for(let s=a.length-1;s>-1;s-=1)if(!a[s].disabled)return s}return t}function mt(t,a,l){for(let s=t+1;s<a.length;s+=1)if(!a[s].disabled)return s;if(l){for(let s=0;s<a.length;s+=1)if(!a[s].disabled)return s}return t}function gt(t,a,l){return de(t,l)===de(a,l)}function xt({parentSelector:t,siblingSelector:a,onKeyDown:l,loop:s=!0,activateOnFocus:n=!1,dir:m="rtl",orientation:h}){return d=>{l?.(d);const u=Array.from(de(d.currentTarget,t)?.querySelectorAll(a)||[]).filter(f=>gt(d.currentTarget,f,t)),b=u.findIndex(f=>d.currentTarget===f),y=mt(b,u,s),T=pt(b,u,s),o=m==="rtl"?T:y,v=m==="rtl"?y:T;switch(d.key){case"ArrowRight":{h==="horizontal"&&(d.stopPropagation(),d.preventDefault(),u[o].focus(),n&&u[o].click());break}case"ArrowLeft":{h==="horizontal"&&(d.stopPropagation(),d.preventDefault(),u[v].focus(),n&&u[v].click());break}case"ArrowUp":{h==="vertical"&&(d.stopPropagation(),d.preventDefault(),u[T].focus(),n&&u[T].click());break}case"ArrowDown":{h==="vertical"&&(d.stopPropagation(),d.preventDefault(),u[y].focus(),n&&u[y].click());break}case"Home":{d.stopPropagation(),d.preventDefault(),!u[0].disabled&&u[0].focus();break}case"End":{d.stopPropagation(),d.preventDefault();const f=u.length-1;!u[f].disabled&&u[f].focus();break}}}}const[jt,ue]=Ee("Tabs component was not found in the tree");var Q={root:"m_89d60db1","list--default":"m_576c9d4",list:"m_89d33d6d",tab:"m_4ec4dce6",panel:"m_b0c91715",tabSection:"m_fc420b1f",tabLabel:"m_42bbd1ae","tab--default":"m_539e827b","list--outline":"m_6772fbd5","tab--outline":"m_b59ab47c","tab--pills":"m_c3381914"};const pe=le((t,a)=>{const l=ne("TabsList",null,t),{children:s,className:n,grow:m,justify:h,classNames:d,styles:u,style:b,mod:y,...T}=l,o=ue();return e.jsx(Y,{...T,...o.getStyles("list",{className:n,style:b,classNames:d,styles:u,props:l,variant:o.variant}),ref:a,role:"tablist",variant:o.variant,mod:[{grow:m,orientation:o.orientation,placement:o.orientation==="vertical"&&o.placement,inverted:o.inverted},y],"aria-orientation":o.orientation,__vars:{"--tabs-justify":h},children:s})});pe.classes=Q;pe.displayName="@mantine/core/TabsList";const me=le((t,a)=>{const l=ne("TabsPanel",null,t),{children:s,className:n,value:m,classNames:h,styles:d,style:u,mod:b,keepMounted:y,...T}=l,o=ue(),v=o.value===m,f=o.keepMounted||y||v?s:null;return e.jsx(Y,{...o.getStyles("panel",{className:n,classNames:h,styles:d,style:[u,v?void 0:{display:"none"}],props:l}),ref:a,mod:[{orientation:o.orientation},b],role:"tabpanel",id:o.getPanelId(m),"aria-labelledby":o.getTabId(m),...T,children:f})});me.classes=Q;me.displayName="@mantine/core/TabsPanel";const ge=le((t,a)=>{const l=ne("TabsTab",null,t),{className:s,children:n,rightSection:m,leftSection:h,value:d,onClick:u,onKeyDown:b,disabled:y,color:T,style:o,classNames:v,styles:f,vars:F,mod:x,tabIndex:A,...p}=l,S=Pe(),{dir:_}=Oe(),g=ue(),k=d===g.value,O=q=>{g.onChange(g.allowTabDeactivation&&d===g.value?null:d),u?.(q)},r={classNames:v,styles:f,props:l};return e.jsxs(Be,{...g.getStyles("tab",{className:s,style:o,variant:g.variant,...r}),disabled:y,unstyled:g.unstyled,variant:g.variant,mod:[{active:k,disabled:y,orientation:g.orientation,inverted:g.inverted,placement:g.orientation==="vertical"&&g.placement},x],ref:a,role:"tab",id:g.getTabId(d),"aria-selected":k,tabIndex:A!==void 0?A:k||g.value===null?0:-1,"aria-controls":g.getPanelId(d),onClick:O,__vars:{"--tabs-color":T?Le(T,S):void 0},onKeyDown:xt({siblingSelector:'[role="tab"]',parentSelector:'[role="tablist"]',activateOnFocus:g.activateTabWithKeyboard,loop:g.loop,orientation:g.orientation||"horizontal",dir:_,onKeyDown:b}),...p,children:[h&&e.jsx("span",{...g.getStyles("tabSection",r),"data-position":"left",children:h}),n&&e.jsx("span",{...g.getStyles("tabLabel",r),children:n}),m&&e.jsx("span",{...g.getStyles("tabSection",r),"data-position":"right",children:m})]})});ge.classes=Q;ge.displayName="@mantine/core/TabsTab";const Ae="Tabs.Tab or Tabs.Panel component was rendered with invalid value or without value",bt={keepMounted:!0,orientation:"horizontal",loop:!0,activateTabWithKeyboard:!0,variant:"default",placement:"left"},vt=Ue((t,{radius:a,color:l,autoContrast:s})=>({root:{"--tabs-radius":Je(a),"--tabs-color":Le(l,t),"--tabs-text-color":Ve(s,t)?He({color:l,theme:t,autoContrast:s}):void 0}})),P=le((t,a)=>{const l=ne("Tabs",bt,t),{defaultValue:s,value:n,onChange:m,orientation:h,children:d,loop:u,id:b,activateTabWithKeyboard:y,allowTabDeactivation:T,variant:o,color:v,radius:f,inverted:F,placement:x,keepMounted:A,classNames:p,styles:S,unstyled:_,className:g,style:k,vars:O,autoContrast:r,mod:q,attributes:H,...i}=l,M=qe(b),[re,oe]=$e({value:n,defaultValue:s,finalValue:null,onChange:m}),ee=We({name:"Tabs",props:l,classes:Q,className:g,style:k,classNames:p,styles:S,unstyled:_,attributes:H,vars:O,varsResolver:vt});return e.jsx(jt,{value:{placement:x,value:re,orientation:h,id:M,loop:u,activateTabWithKeyboard:y,getTabId:Se(`${M}-tab`,Ae),getPanelId:Se(`${M}-panel`,Ae),onChange:oe,allowTabDeactivation:T,variant:o,color:v,radius:f,inverted:F,keepMounted:A,unstyled:_,getStyles:ee},children:e.jsx(Y,{ref:a,id:M,variant:o,mod:[{orientation:h,inverted:h==="horizontal"&&F,placement:h==="vertical"&&x},q],...ee("root"),...i,children:d})})});P.classes=Q;P.displayName="@mantine/core/Tabs";P.Tab=ge;P.Panel=me;P.List=pe;const ft=[["path",{d:"M7 12l5 5l10 -10",key:"svg-0"}],["path",{d:"M2 12l5 5m5 -5l5 -5",key:"svg-1"}]],yt=X("outline","checks","Checks",ft);const wt=[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M12 7v5l3 3",key:"svg-1"}]],Tt=X("outline","clock","Clock",wt);const St=[["path",{d:"M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2",key:"svg-0"}],["path",{d:"M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-1"}],["path",{d:"M14 4l0 4l-6 0l0 -4",key:"svg-2"}]],At=X("outline","device-floppy","DeviceFloppy",St);const kt=[["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z",key:"svg-1"}],["path",{d:"M12 17v-6",key:"svg-2"}],["path",{d:"M9.5 14.5l2.5 2.5l2.5 -2.5",key:"svg-3"}]],ke=X("outline","file-download","FileDownload",kt);const Lt=[["path",{d:"M7 3.34a10 10 0 1 1 -4.995 8.984l-.005 -.324l.005 -.324a10 10 0 0 1 4.995 -8.336z",key:"svg-0"}]],ae=X("filled","circle-filled","CircleFilled",Lt),Ie=async()=>(await U.get("/api/applications/business/dashboard/metrics")).data,Ct=async t=>{const a=new URLSearchParams(Object.entries(t).filter(([s,n])=>n!==void 0&&n!=="All").map(([s,n])=>[s,String(n)])).toString();return(await U.get(`/api/listings/business-listings?${a}`)).data},zt=async t=>{const a=new URLSearchParams(Object.entries(t).filter(([s,n])=>n!==void 0&&n!=="All"&&n!=="all").map(([s,n])=>[s,String(n)])).toString();return(await U.get(`/api/applications/business-applications?${a}`)).data},Dt=async(t,a)=>(await U.patch(`/api/applications/status/${t}`,{status:a})).data,It=async t=>(await U.delete(`/api/listings/${t}`)).data,Ft=async t=>(await U.delete(`/api/applications/${t}`)).data,_t=({opened:t,onClose:a,handleDelete:l,applicationId:s,applicationTitle:n})=>{const[m,h]=w.useState(!1);return e.jsxs(he,{opened:t,onClose:a,title:"Delete application",centered:!0,children:[e.jsxs(j,{children:["Are you sure you want to delete the",e.jsxs("span",{style:{fontWeight:"bold"},children:[" ",n," "]}),"application?"]}),e.jsxs(D,{mt:20,justify:"flex-end",gap:"sm",children:[e.jsx(K,{variant:"outline",onClick:a,children:"Cancel"}),e.jsx(K,{color:"red",onClick:()=>{a(),l(s)},loading:m,children:"Delete"})]})]})};function Rt({matchScore:t}){if(!t||t===null||t===void 0)return e.jsx(be,{style:{borderColor:"gray"},c:"gray",size:"lg",variant:"outline",radius:"md",h:"100%",children:"N/A"});const a=Math.round(t*100),l=a>=80?"green":a>=60?"blue":"darkRed";return console.log(t),e.jsxs(be,{style:{borderColor:l},c:l,size:"lg",variant:"outline",radius:"md",h:"100%",children:[a,"%"]})}const Nt=({dashApplications:t,searchText:a,setSearchText:l,status:s,setStatus:n,listingId:m,setListingId:h,dateFrom:d,setDateFrom:u,dateTo:b,setDateTo:y,sortOption:T,setSortOption:o,page:v,setPage:f,onStatusChange:F,listingOptions:x,updateApplicationStatus:A,newStatus:p,setNewStatus:S,handleApplicationDelete:_})=>{const[g,{open:k,close:O}]=ce(!1),[r,q]=w.useState(null),H=(i,M)=>{q({id:i,title:M}),k()};return e.jsxs(e.Fragment,{children:[e.jsxs(z,{children:[e.jsxs(z,{gap:"md",hiddenFrom:"md",children:[e.jsx(I,{label:"Listing",value:m,onChange:i=>h(i),data:x}),e.jsx(N,{type:"date",label:"From",value:d||"",onChange:i=>u(i.target.value)}),e.jsx(N,{type:"date",label:"To",value:b||"",onChange:i=>y(i.target.value)}),e.jsx(I,{label:"Status",value:s,onChange:i=>n(i),data:[{value:"all",label:"All Statuses"},{value:"pending",label:"Pending"},{value:"reviewed",label:"Reviewed"},{value:"rejected",label:"Rejected"}]}),e.jsx(N,{label:"Search",value:a,onChange:i=>l(i.target.value),placeholder:"Search applications..."}),e.jsx(I,{label:"Sort",value:T,onChange:i=>o(i),data:[{value:"date-newest",label:"Newest First"},{value:"date-oldest",label:"Oldest First"},{value:"name-asc",label:"Name (A-Z)"},{value:"name-desc",label:"Name (Z-A)"},{value:"match-desc",label:"Match (High to Low)"},{value:"match-asc",label:"Match (Low to High)"}]})]}),e.jsxs(D,{justify:"center",align:"center",visibleFrom:"md",children:[e.jsx(I,{label:"Listing",w:"15%",value:m,onChange:i=>h(i),data:x}),e.jsx(N,{type:"date",label:"From",value:d||"",onChange:i=>u(i.target.value),w:"15%"}),e.jsx(N,{type:"date",label:"To",value:b||"",onChange:i=>y(i.target.value),w:"15%"}),e.jsx(I,{label:"Status",w:"15%",value:s,onChange:i=>n(i),data:[{value:"all",label:"All Statuses"},{value:"pending",label:"Pending"},{value:"reviewed",label:"Reviewed"},{value:"rejected",label:"Rejected"}]}),e.jsx(N,{label:"Search",w:"15%",value:a,onChange:i=>l(i.target.value),placeholder:"Search applications..."}),e.jsx(I,{label:"Sort",w:"15%",value:T,onChange:i=>o(i),data:[{value:"date-newest",label:"Newest First"},{value:"date-oldest",label:"Oldest First"},{value:"name-asc",label:"Name (A-Z)"},{value:"name-desc",label:"Name (Z-A)"},{value:"match-desc",label:"Match (High to Low)"},{value:"match-asc",label:"Match (Low to High)"}]})]}),t?.length===0?e.jsx(Ce,{title:"No Applications Found",description:"You haven't received any applications yet. Make sure your job listings are active and visible to attract candidates."}):e.jsxs(e.Fragment,{children:[e.jsx(z,{hiddenFrom:"md",gap:"md",children:t?.map(i=>e.jsx(ze,{withBorder:!0,p:"md",children:e.jsxs(z,{gap:"xs",children:[e.jsxs(D,{justify:"space-between",children:[e.jsxs(j,{fw:600,size:"lg",children:[i.firstName," ",i.lastName]}),e.jsx(W,{size:36,variant:"outline",color:"red",onClick:()=>{H(i._id,`${typeof i.listingId=="object"&&i.listingId.jobTitle}`)},children:e.jsx(ie,{size:20})})]}),e.jsx(j,{size:"sm",c:"dimmed",children:typeof i.listingId=="object"&&i.listingId.jobTitle}),e.jsx(j,{size:"sm",children:i.email}),i.phone&&e.jsx(j,{size:"sm",children:i.phone}),e.jsxs(j,{size:"xs",c:"dimmed",children:["Submitted: ",i.createdAt&&new Date(i.createdAt).toLocaleString()]}),e.jsxs(D,{gap:"xs",mt:"xs",children:[e.jsx(ve,{href:i.resumeUrl,target:"_blank",children:e.jsx(W,{variant:"light",size:36,children:e.jsx(ke,{size:20})})}),e.jsx(I,{flex:1,value:p||i.status,onChange:M=>A(i._id,M),data:[{value:"pending",label:"Pending"},{value:"reviewed",label:"Reviewed"},{value:"rejected",label:"Rejected"}]})]})]})},i._id))}),e.jsx(Y,{visibleFrom:"md",children:e.jsx(c.ScrollContainer,{minWidth:900,children:e.jsxs(c,{verticalSpacing:"sm",maw:"100%",mx:"auto",children:[e.jsx(c.Thead,{children:e.jsxs(c.Tr,{children:[e.jsx(c.Th,{}),e.jsx(c.Th,{children:"Applicant"}),e.jsx(c.Th,{children:"Listing"}),e.jsx(c.Th,{children:"Phone"}),e.jsx(c.Th,{children:"Email"}),e.jsx(c.Th,{children:"Submitted"}),e.jsx(c.Th,{children:"Resume"}),e.jsx(c.Th,{children:"Match"}),e.jsx(c.Th,{children:"Status"}),e.jsx(c.Th,{children:"Actions"})]})}),e.jsx(c.Tbody,{children:t?.map(i=>e.jsxs(c.Tr,{children:[e.jsx(c.Td,{styles:{td:{borderLeft:"1px solid #eee",borderRight:"1px solid #eee"}},children:e.jsx(j,{fz:"sm",fw:"bold",c:"dimmed",ta:"center",children:t.indexOf(i)+1})}),e.jsx(c.Td,{children:e.jsxs(j,{fz:"sm",fw:500,children:[i.firstName," ",i.lastName]})}),e.jsx(c.Td,{children:e.jsx(j,{fz:"sm",fw:500,children:typeof i.listingId=="object"&&i.listingId.jobTitle})}),e.jsx(c.Td,{children:e.jsx(j,{fz:"sm",fw:500,children:i.phone})}),e.jsx(c.Td,{children:e.jsx(j,{fz:"sm",children:i.email})}),e.jsx(c.Td,{children:i.createdAt&&new Date(i.createdAt).toLocaleString()}),e.jsx(c.Td,{children:e.jsx(ve,{href:i.resumeUrl,target:"_blank",children:e.jsx(ke,{size:30})})}),e.jsx(c.Td,{w:75,children:e.jsx(Rt,{matchScore:i.matchScore})}),e.jsx(c.Td,{children:e.jsx(I,{px:5,value:p||i.status,onChange:M=>A(i._id,M),data:[{value:"pending",label:"Pending"},{value:"reviewed",label:"Reviewed"},{value:"rejected",label:"Rejected"}]})}),e.jsx(c.Td,{styles:{td:{borderRight:"1px solid #eee"}},children:e.jsx(D,{gap:"xs",children:e.jsx(W,{size:30,variant:"outline",color:"red",onClick:()=>{H(i._id,`${typeof i.listingId=="object"&&i.listingId.jobTitle}`)},children:e.jsx(ie,{size:25,stroke:1.5})})})})]},i._id))})]})})})]})]}),e.jsx(_t,{opened:g,onClose:O,applicationId:r?.id||"",applicationTitle:r?.title||"",handleDelete:_})]})},Mt=({opened:t,onClose:a,handleDelete:l,listingId:s,listingTitle:n})=>{const[m,h]=w.useState(!1);return e.jsxs(he,{opened:t,onClose:a,title:"Delete Listing",centered:!0,children:[e.jsxs(j,{children:["Are you sure you want to delete the",e.jsxs("span",{style:{fontWeight:"bold"},children:[" ",n," "]}),"listing?"]}),e.jsxs(D,{mt:20,justify:"flex-end",gap:"sm",children:[e.jsx(K,{variant:"outline",onClick:a,children:"Cancel"}),e.jsx(K,{color:"red",onClick:()=>{a(),l(s)},loading:m,children:"Delete"})]})]})},Et=({opened:t,onClose:a,listing:l,setListings:s})=>{const[n,m]=w.useState(!1),{register:h,handleSubmit:d,reset:u,formState:{errors:b,isValid:y,isDirty:T},control:o,setValue:v}=Ze({mode:"all",resolver:Ge(ht)});w.useEffect(()=>{if(t&&l){const p=ct(l);u(p)}},[t]);const f=fe({control:o,name:"location.region"}),F=fe({control:o,name:"apply.method"}),x=w.useMemo(()=>f?Ke(f).map(p=>({value:p,label:p})):[],[f]),A=async p=>{try{m(!0);const S=await U.put(`/api/listings/${l?._id}`,{...p,expiresAt:p.expiresAt?new Date(p.expiresAt).toISOString():null});s(_=>_.map(g=>g._id===S.data._id?S.data:g)),B.show({title:"Success",message:"Listing updated successfully!",color:"green"}),a()}catch(S){B.show({title:"Error",message:`Update failed! ${S?.response?.data?.message||S.message}`,color:"red"})}finally{m(!1)}};return e.jsx(he,{opened:t,onClose:a,title:"Delete application",centered:!0,size:"xl",zIndex:100,children:e.jsxs(z,{gap:"md",p:"md",children:[e.jsx(Ye,{justify:"space-between",align:"center",children:e.jsx(De,{order:2,children:"Edit Listing"})}),e.jsx("form",{onSubmit:d(A),children:e.jsxs(z,{gap:"md",children:[e.jsx(te,{legend:"Job Info",children:e.jsxs(z,{gap:"sm",children:[e.jsx(N,{label:"Company Name",required:!0,...h("companyName"),error:b.companyName?.message}),e.jsx(N,{label:"Job Title",required:!0,...h("jobTitle"),error:b.jobTitle?.message}),e.jsx(Xe,{label:"Job Description",required:!0,minRows:4,...h("jobDescription"),error:b.jobDescription?.message}),e.jsx($,{name:"requirements",control:o,render:({field:p})=>e.jsx(ye,{label:"Requirements",placeholder:"Type a requirement and press Enter",description:"Add job requirements (max 20)",maxTags:20,...p,error:b.requirements?.message})}),e.jsx($,{name:"advantages",control:o,render:({field:p})=>e.jsx(ye,{label:"Nice to Have",placeholder:"Type an advantage and press Enter",description:"Add nice-to-have qualifications (max 20)",maxTags:20,...p,error:b.advantages?.message})})]})}),e.jsx(te,{legend:"Application",children:e.jsxs(z,{gap:"sm",children:[e.jsx(j,{size:"sm",c:"dimmed",children:"Choose how candidates can apply to this position."}),e.jsx(se.Group,{label:"Application Method",description:"Select one method for receiving applications",required:!0,children:e.jsxs(z,{mt:"xs",children:[e.jsx($,{name:"apply.method.jobRocketSystem",control:o,render:({field:p})=>e.jsx(se,{label:"JobRocket Internal System",description:"Candidates apply through JobRocket",value:"jobRocketSystem",checked:p.value,onChange:()=>{v("apply.method.jobRocketSystem",!0),v("apply.method.companySystem",!1),v("apply.method.email",!1),v("apply.contact.email",""),v("apply.contact.link","")}})}),e.jsx($,{name:"apply.method.email",control:o,render:({field:p})=>e.jsx(se,{label:"Email Applications",description:"Candidates send applications via email",value:"email",checked:p.value,onChange:()=>{v("apply.method.jobRocketSystem",!1),v("apply.method.companySystem",!1),v("apply.method.email",!0),v("apply.contact.link","")}})}),e.jsx($,{name:"apply.method.companySystem",control:o,render:({field:p})=>e.jsx(se,{label:"External Company System",description:"Candidates apply through external link",value:"companySystem",checked:p.value,onChange:()=>{v("apply.method.jobRocketSystem",!1),v("apply.method.companySystem",!0),v("apply.method.email",!1),v("apply.contact.email","")}})})]})}),F?.email&&e.jsx(N,{label:"Email for Applications",placeholder:"careers@company.com",required:!0,...h("apply.contact.email"),error:b.apply?.contact?.email?.message}),F?.companySystem&&e.jsx(N,{label:"External Application Link",placeholder:"https://company.com/careers/apply",required:!0,...h("apply.contact.link"),error:b.apply?.contact?.link?.message})]})}),e.jsx(te,{legend:"Location",children:e.jsxs(z,{gap:"sm",children:[e.jsx($,{name:"location.region",control:o,render:({field:p})=>e.jsx(I,{label:"Region",required:!0,searchable:!0,data:Qe.map(S=>({value:S,label:S})),...p,error:b.location?.region?.message})}),e.jsx($,{name:"location.city",control:o,render:({field:p})=>e.jsx(I,{label:"City",required:!0,searchable:!0,disabled:!f,data:x,...p,error:b.location?.city?.message})})]})}),e.jsx(te,{legend:"Job Details",children:e.jsxs(z,{gap:"sm",children:[e.jsx($,{name:"workArrangement",control:o,render:({field:p})=>e.jsx(I,{label:"Work Arrangement",required:!0,searchable:!0,data:et.map(S=>({value:S,label:S})),...p,error:b.workArrangement?.message})}),e.jsx($,{name:"isActive",control:o,render:({field:p})=>e.jsx(dt,{label:"Listing is active",checked:p.value,onChange:S=>p.onChange(S.currentTarget.checked)})}),e.jsx(N,{label:"Expiration Date",type:"date",...h("expiresAt"),error:b.expiresAt?.message})]})}),e.jsx(D,{justify:"space-between",mt:"md",children:e.jsx(K,{type:"submit",variant:"filled",color:"green",leftSection:e.jsx(At,{size:16}),disabled:!y||!T,loading:n,children:"Save Changes"})})]})})]})})},Pt=({listings:t,handleDelete:a,searchText:l,setSearchText:s,sortOption:n,setSortOption:m,activeFilter:h,setActiveFilter:d,page:u,setPage:b,setListings:y})=>{const[T,{open:o,close:v}]=ce(!1),[f,F]=w.useState(null),[x,{open:A,close:p}]=ce(!1),[S,_]=w.useState(),g=tt(),k=(r,q)=>{F({id:r,title:q}),o()},O=r=>{_(r),A()};return t.length===0?e.jsx(Ce,{title:"No Listings Found",description:"You haven't created any job listings yet. Start attracting top talent by creating your first listing!",action:{label:"Create Your First Listing",onClick:()=>g("/create-listing")}}):e.jsxs(e.Fragment,{children:[e.jsxs(z,{children:[e.jsxs(z,{gap:"md",hiddenFrom:"md",children:[e.jsx(N,{label:"Search listings",placeholder:"Search listings",value:l,onChange:r=>s(r.target.value)}),e.jsx(I,{label:"Sort by",placeholder:"Select sort option",value:n,onChange:r=>{m(r)},data:[{value:"all",label:"All Listings"},{value:"date-created-new",label:"Newest First"},{value:"date-created-old",label:"Oldest First"},{value:"favorites-most",label:"Most Favorited"},{value:"favorites-least",label:"Least Favorited"},{value:"title-asc",label:"Title A-Z"},{value:"title-desc",label:"Title Z-A"}]}),e.jsx(I,{label:"Filter by status",placeholder:"Select active filter",value:h,onChange:r=>{d(r)},data:[{value:"all",label:"All Listings"},{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}]})]}),e.jsxs(D,{justify:"center",visibleFrom:"md",children:[e.jsx(N,{label:"Search listings",placeholder:"Search listings",value:l,onChange:r=>s(r.target.value)}),e.jsx(I,{label:"Sort by",placeholder:"Select sort option",value:n,onChange:r=>{m(r)},data:[{value:"all",label:"All Listings"},{value:"date-created-new",label:"Newest First"},{value:"date-created-old",label:"Oldest First"},{value:"favorites-most",label:"Most Favorited"},{value:"favorites-least",label:"Least Favorited"},{value:"title-asc",label:"Title A-Z"},{value:"title-desc",label:"Title Z-A"}]}),e.jsx(I,{label:"Filter by status",placeholder:"Select active filter",value:h,onChange:r=>{d(r)},data:[{value:"all",label:"All Listings"},{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}]})]}),e.jsx(z,{hiddenFrom:"md",gap:"md",children:t?.map(r=>e.jsx(ze,{withBorder:!0,p:"md",children:e.jsxs(z,{gap:"xs",children:[e.jsxs(D,{justify:"space-between",align:"start",children:[e.jsx("div",{children:e.jsx(j,{fw:600,size:"lg",children:r.jobTitle})}),r.isActive?e.jsx(ae,{size:20,color:"green"}):e.jsx(ae,{size:20,color:"red"})]}),e.jsxs(D,{gap:"xs",children:[e.jsxs(j,{size:"xs",c:"dimmed",children:["Created: ",r.createdAt&&new Date(r.createdAt).toLocaleDateString()]}),e.jsx(j,{size:"xs",c:"dimmed",children:"â€¢"}),e.jsxs(j,{size:"xs",c:"dimmed",children:[r.likes?.length||0," favorites"]})]}),r.expiresAt&&e.jsxs(j,{size:"xs",c:"dimmed",children:["Expires: ",r.expiresAt]}),e.jsxs(D,{gap:"xs",mt:"xs",children:[e.jsx(W,{size:36,variant:"outline",color:"yellow",onClick:()=>O(r),children:e.jsx(Te,{size:20})}),e.jsx(W,{size:36,variant:"outline",color:"red",onClick:()=>k(r._id,r.jobTitle),children:e.jsx(ie,{size:20})})]})]})},r._id))}),e.jsx(Y,{visibleFrom:"md",children:e.jsx(c.ScrollContainer,{minWidth:800,children:e.jsxs(c,{verticalSpacing:"sm",maw:"100%",mx:"auto",children:[e.jsx(c.Thead,{children:e.jsxs(c.Tr,{children:[e.jsx(c.Th,{}),e.jsx(c.Th,{children:"Job Title"}),e.jsx(c.Th,{children:"Created At"}),e.jsx(c.Th,{children:"Expires At"}),e.jsx(c.Th,{children:"Active"}),e.jsx(c.Th,{children:"Favorites"}),e.jsx(c.Th,{children:"Edit"}),e.jsx(c.Th,{children:"Delete"})]})}),e.jsx(c.Tbody,{children:t?.map(r=>e.jsxs(c.Tr,{children:[e.jsx(c.Td,{styles:{td:{borderLeft:"1px solid #eee",borderRight:"1px solid #eee"}},children:e.jsx(j,{fz:"sm",fw:"bold",c:"dimmed",ta:"center",children:t.indexOf(r)+1})}),e.jsx(c.Td,{children:e.jsx(j,{fz:"sm",fw:500,children:r.jobTitle})}),e.jsx(c.Td,{children:r.createdAt&&new Date(r.createdAt).toLocaleString()}),e.jsx(c.Td,{children:e.jsx(j,{fz:"sm",children:r.expiresAt})}),e.jsx(c.Td,{children:r.isActive===!0?e.jsx(ae,{size:16,color:"green"}):e.jsx(ae,{size:16,color:"red"})}),e.jsx(c.Td,{children:e.jsx(j,{fz:"sm",children:r.likes?.length})}),e.jsx(c.Td,{children:e.jsx(W,{size:30,variant:"outline",color:"yellow",onClick:()=>O(r),children:e.jsx(Te,{size:25,stroke:1.5})})}),e.jsx(c.Td,{styles:{td:{borderRight:"1px solid #eee"}},children:e.jsx(W,{size:30,variant:"outline",color:"red",onClick:()=>k(r._id,r.jobTitle),children:e.jsx(ie,{size:25,stroke:1.5})})})]},r._id))})]})})})]}),e.jsx(Et,{opened:x,onClose:p,listing:S,setListings:y}),e.jsx(Mt,{opened:T,onClose:v,listingId:f?.id||"",listingTitle:f?.title||"",handleDelete:a})]})},Ot=({dashboardMetrics:t})=>e.jsx(st,{cols:{base:1,xs:2,sm:3,md:5},spacing:"md",children:e.jsxs(e.Fragment,{children:[e.jsxs(Z,{shadow:"sm",p:"md",radius:"md",withBorder:!0,className:we.cardGradientSubtle,children:[e.jsxs(D,{justify:"space-between",mb:"xs",children:[e.jsx(j,{size:"xs",c:"dimmed",fw:700,tt:"uppercase",children:"Total Applications"}),e.jsx(G,{color:"rocketOrange",variant:"light",size:"lg",radius:"md",children:e.jsx(ut,{size:20})})]}),e.jsx(j,{size:"xl",fw:700,children:t?.metrics?.totalApplications||0})]}),e.jsxs(Z,{shadow:"sm",p:"md",radius:"md",withBorder:!0,className:we.cardGradientRed,children:[e.jsxs(D,{justify:"space-between",mb:"xs",children:[e.jsx(j,{size:"xs",c:"dimmed",fw:700,tt:"uppercase",children:"Total Listings"}),e.jsx(G,{color:"rocketRed",variant:"light",size:"lg",radius:"md",children:e.jsx(at,{size:20})})]}),e.jsx(j,{size:"xl",fw:700,children:t?.metrics?.totalListings||0})]}),e.jsxs(Z,{shadow:"sm",p:"md",radius:"md",withBorder:!0,children:[e.jsxs(D,{justify:"space-between",mb:"xs",children:[e.jsx(j,{size:"xs",c:"dimmed",fw:700,tt:"uppercase",children:"Pending"}),e.jsx(G,{color:"yellow",variant:"light",size:"lg",radius:"md",children:e.jsx(Tt,{size:20})})]}),e.jsx(j,{size:"xl",fw:700,children:t?.metrics?.pendingApplications||0})]}),e.jsxs(Z,{shadow:"sm",p:"md",radius:"md",withBorder:!0,children:[e.jsxs(D,{justify:"space-between",mb:"xs",children:[e.jsx(j,{size:"xs",c:"dimmed",fw:700,tt:"uppercase",children:"Reviewed"}),e.jsx(G,{color:"green",variant:"light",size:"lg",radius:"md",children:e.jsx(yt,{size:20})})]}),e.jsx(j,{size:"xl",fw:700,children:t?.metrics?.reviewedApplications||0})]}),e.jsxs(Z,{shadow:"sm",p:"md",radius:"md",withBorder:!0,children:[e.jsxs(D,{justify:"space-between",mb:"xs",children:[e.jsx(j,{size:"xs",c:"dimmed",fw:700,tt:"uppercase",children:"Rejected"}),e.jsx(G,{color:"red",variant:"light",size:"lg",radius:"md",children:e.jsx(it,{size:20})})]}),e.jsx(j,{size:"xl",fw:700,children:t?.metrics?.rejectedApplications||0})]})]})}),Bt=()=>{const[t,a]=w.useState([]),[l,s]=w.useState(!1),[n,m]=w.useState(""),[h,d]=w.useState("all"),[u,b]=w.useState("date-created-new"),[y,T]=w.useState(1),o=async()=>{s(!0);try{const x=await Ct({searchText:n||void 0,sortOption:u,page:y,limit:20});a(x.listings)}catch(x){B.show({title:"Error",message:x.response?.data?.message||"Failed to load listings",color:"red"})}finally{s(!1)}},v=x=>t.filter(A=>A._id!==x);w.useEffect(()=>{o()},[n,u,y]);const f=t.filter(x=>{if(h==="all")return!0;if(h==="active")return x.isActive===!0;if(h==="inactive")return x.isActive===!1});return{listings:u?.startsWith("favorites")?u==="favorites-least"?f.sort((x,A)=>(x.likes?.length||0)-(A.likes?.length||0)):f.sort((x,A)=>(A.likes?.length||0)-(x.likes?.length||0)):f,setListings:a,isLoading:l,searchText:n,activeFilter:h,sortOption:u,page:y,setSearchText:m,setActiveFilter:d,setSortOption:b,setPage:T,refetchListings:o,removeListingById:v}},qt=()=>{const[t,a]=w.useState([]),[l,s]=w.useState(!1),[n,m]=w.useState(""),[h,d]=w.useState("all"),[u,b]=w.useState("all"),[y,T]=w.useState(""),[o,v]=w.useState(""),[f,F]=w.useState("date-newest"),[x,A]=w.useState(1),[p,S]=w.useState(null),_=g=>t.filter(k=>k._id!==g);return w.useEffect(()=>{(async()=>{s(!0);try{const k=await zt({searchText:n||void 0,status:h,listingId:u,dateFrom:y||void 0,dateTo:o||void 0,sortOption:f,page:x,limit:20});a(k.applications)}catch(k){B.show({title:"Error",message:k.response?.data?.message||"Failed to load applications",color:"red"})}finally{s(!1)}})()},[n,h,u,y,o,f,x]),{applications:t,isLoading:l,searchText:n,status:h,listingId:u,dateFrom:y,dateTo:o,sortOption:f,page:x,setSearchText:m,setStatus:d,setListingId:b,setDateFrom:T,setDateTo:v,setSortOption:F,setPage:A,newStatus:p,setNewStatus:S,setApplications:a,removeApplicationById:_}},$t=()=>{const[t,a]=w.useState(!1),[l,s]=w.useState(),n=async()=>{try{a(!0);const m=await Ie();s(m)}catch(m){B.show({title:"Error",message:m.response?.data?.message||m.message,color:"red"})}finally{a(!1)}};return w.useEffect(()=>{n()},[]),{dashboardMetrics:l,setDashboardMetrics:s,getDashboardMetrics:n}},Zt=()=>{const[t,a]=w.useState(!1),{dashboardMetrics:l,setDashboardMetrics:s}=$t(),{listings:n,setListings:m,isLoading:h,searchText:d,setSearchText:u,sortOption:b,setSortOption:y,activeFilter:T,setActiveFilter:o,page:v,setPage:f,removeListingById:F}=Bt(),{applications:x,searchText:A,setSearchText:p,status:S,setStatus:_,listingId:g,setListingId:k,dateFrom:O,setDateFrom:r,dateTo:q,setDateTo:H,sortOption:i,setSortOption:M,page:re,setPage:oe,newStatus:ee,setNewStatus:Fe,setApplications:xe,removeApplicationById:_e}=qt(),Re=[{value:"all",label:"All Listings"},...n.map(R=>({value:R._id,label:R.jobTitle}))??[]],Ne=async R=>{if(!R)return;const E=F(R);m(E);try{await It(R),B.show({title:"Success",message:"Listing deleted successfully",color:"green"})}catch(C){B.show({title:"Error",message:C.response?.data?.message||"Failed to delete listing",color:"red"})}s(C=>C&&{...C,metrics:{...C.metrics,totalListings:E.length}})},Me=async R=>{if(!R)return;const E=_e(R);xe(E);try{await Ft(R),B.show({title:"Success",message:"Application deleted successfully",color:"green"})}catch(C){B.show({title:"Error",message:C.response?.data?.message||"Failed to delete application",color:"red"})}s(C=>C&&{...C,metrics:{...C.metrics,totalApplications:E.length,pendingApplications:E.filter(L=>L.status==="pending").length,reviewedApplications:E.filter(L=>L.status==="reviewed").length,rejectedApplications:E.filter(L=>L.status==="rejected").length}})},je=async(R,E)=>{if(!E)return;const C=E;try{await Dt(R,C);const L=await Ie();s(L)}catch(L){B.show({title:"Error",message:L.response?.data?.message||"Failed to update application status",color:"red"})}xe(L=>L&&L.map(J=>J._id===R?{...J,status:C}:J)),s(L=>{if(!L)return L;const J={pendingApplications:x.filter(V=>V.status==="pending").length,reviewedApplications:x.filter(V=>V.status==="reviewed").length,rejectedApplications:x.filter(V=>V.status==="rejected").length};return{...L,metrics:{...L.metrics,updatedMetrics:J}}})};return e.jsxs(e.Fragment,{children:[e.jsx(lt,{title:"Dashboard | JobRocket",description:"Manage your listings and applications.",keywords:"analytics, dashboard, job applications, manage job applications, manage job listings"}),t?e.jsx(nt,{py:50,h:"calc(100vh - 200px)",children:e.jsx(rt,{size:"xl",variant:"oval"})}):e.jsx(ot,{size:"xl",py:"xl",w:{base:"100%",sm:"95%",md:"85%"},children:e.jsxs(z,{gap:"xl",children:[e.jsxs("div",{children:[e.jsx(De,{order:1,mb:"xs",children:"Dashboard"}),e.jsx(j,{c:"dimmed",size:"lg",children:"Welcome back! Here's your overview"})]}),e.jsx(Ot,{dashboardMetrics:l}),e.jsxs(P,{color:"rocketOrange",variant:"outline",defaultValue:"applications",children:[e.jsxs(P.List,{mb:20,justify:"center",fw:600,children:[e.jsx(P.Tab,{value:"applications",fz:{base:"lg",md:30},children:"Applications"}),e.jsx(P.Tab,{value:"listings",fz:{base:"lg",md:30},children:"Listings"})]}),e.jsx(P.Panel,{value:"applications",children:e.jsx(Nt,{dashApplications:x,listingOptions:Re,onStatusChange:je,searchText:A,setSearchText:p,status:S,setStatus:_,listingId:g,setListingId:k,dateFrom:O,setDateFrom:r,dateTo:q,setDateTo:H,sortOption:i,setSortOption:M,page:re,setPage:oe,updateApplicationStatus:je,newStatus:ee,setNewStatus:Fe,handleApplicationDelete:Me})}),e.jsx(P.Panel,{value:"listings",children:e.jsx(Pt,{listings:n,isLoading:h,searchText:d,setSearchText:u,sortOption:b,setSortOption:y,activeFilter:T,setActiveFilter:o,page:v,setPage:f,handleDelete:Ne,setListings:m})})]})]})})]})};export{Zt as Dashboard};
