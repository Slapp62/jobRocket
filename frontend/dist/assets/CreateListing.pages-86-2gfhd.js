import{O as w,a7 as N,r as y,a9 as L,x as I,z as j,D as J,j as e,Z as D,Q as M,H as P,F as S,I as p,v as c,J as F,K as i,L as f,T as O,S as W,t as g,R as z,W as G,p as V,y as B,o as H,N as k}from"./index-b55nogiJ.js";import{R as d,S as K,l as Q}from"./listing.joi-CPe-UoFL.js";function $(){const v=w(),A=N("(max-width: 700px)"),[R,h]=y.useState(!1),l=L(a=>a.userSlice.user),{reset:x,register:n,handleSubmit:C,control:t,setValue:s,formState:{errors:r,isValid:q}}=I({mode:"all",resolver:B(Q),defaultValues:{companyName:"",requirements:[],advantages:[],apply:{method:{jobRocketSystem:!1,companySystem:!1,email:!1},contact:{email:"",link:""}},location:{region:"",city:""},workArrangement:"",isActive:!0,expiresAt:""}});y.useEffect(()=>{l&&x({companyName:l.businessProfile?.companyName,location:{region:l.businessProfile?.location.region,city:l.businessProfile?.location.city}})},[l,x]);const m=j({control:t,name:"location.region"}),b=j({control:t,name:"apply.method"}),T=y.useMemo(()=>m?J(m).map(a=>({value:a,label:a})):[],[m]),E=async a=>{const o={...a,expiresAt:a.expiresAt?new Date(a.expiresAt).toISOString():null};h(!0);try{(await H.post("/api/listings/",o)).status===201&&(k.show({title:"Success",message:"Listing created!",color:"green"}),v("/dashboard"))}catch(u){k.show({title:"Error",message:`Listing creation failed! ${u?.response?.data||u.message}`,color:"red"})}finally{h(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(D,{title:"Post a Job | JobRocket",description:"Create a new job listing and reach English-speaking candidates in Israel",keywords:"post job, create listing, hire employees, job posting"}),e.jsxs(M,{children:[e.jsx(P,{ta:"center",my:10,children:"Create A Listing"}),e.jsxs("form",{onSubmit:C(E),children:[e.jsxs(S,{direction:"column",gap:10,py:10,mx:"auto",style:{width:A?"90%":"50%"},children:[e.jsxs(p,{legend:"Job Info",children:[e.jsx(c,{label:"Company Name",required:!0,...n("companyName"),error:r.companyName?.message}),e.jsx(c,{label:"Job Title",required:!0,...n("jobTitle"),error:r.jobTitle?.message}),e.jsx(F,{label:"Job Description",minRows:4,required:!0,...n("jobDescription"),error:r.jobDescription?.message}),e.jsx(i,{name:"requirements",control:t,render:({field:a})=>e.jsx(f,{label:"Requirements",placeholder:"Type a requirement and press Enter",description:"Add job requirements (max 20)",maxTags:20,...a,error:r.requirements?.message})}),e.jsx(i,{name:"advantages",control:t,render:({field:a})=>e.jsx(f,{label:"Nice to Have",placeholder:"Type an advantage and press Enter",description:"Add nice-to-have qualifications (max 20)",maxTags:20,...a,error:r.advantages?.message})})]}),e.jsxs(p,{legend:"Application",children:[e.jsx(O,{size:"sm",c:"dimmed",mb:"xs",children:"Choose how candidates can apply to this position."}),e.jsx(d.Group,{label:"Application Method",description:"Select one method for receiving applications",required:!0,children:e.jsxs(W,{mt:"xs",children:[e.jsx(i,{name:"apply.method.jobRocketSystem",control:t,render:({field:a})=>e.jsx(d,{label:"JobRocket Internal System",description:"Candidates apply through JobRocket and you manage applications in your dashboard",value:"jobRocketSystem",checked:a.value,onChange:()=>{s("apply.method.jobRocketSystem",!0),s("apply.method.companySystem",!1),s("apply.method.email",!1),s("apply.contact.email",""),s("apply.contact.link","")}})}),e.jsx(i,{name:"apply.method.email",control:t,render:({field:a})=>e.jsx(d,{label:"Email Applications",description:"Candidates send applications to a specified email address",value:"email",checked:a.value,onChange:()=>{s("apply.method.jobRocketSystem",!1),s("apply.method.companySystem",!1),s("apply.method.email",!0),s("apply.contact.link","")}})}),e.jsx(i,{name:"apply.method.companySystem",control:t,render:({field:a})=>e.jsx(d,{label:"External Company System",description:"Candidates are redirected to your company's application system",value:"companySystem",checked:a.value,onChange:()=>{s("apply.method.jobRocketSystem",!1),s("apply.method.companySystem",!0),s("apply.method.email",!1),s("apply.contact.email","")}})})]})}),b?.email&&e.jsx(c,{label:"Email for Applications",placeholder:"careers@company.com",required:!0,mt:"md",...n("apply.contact.email"),error:r.apply?.contact?.email?.message}),b?.companySystem&&e.jsx(c,{label:"External Application Link",placeholder:"https://company.com/careers/apply",required:!0,mt:"md",...n("apply.contact.link"),error:r.apply?.contact?.link?.message})]}),e.jsxs(p,{legend:"Location",children:[e.jsx(i,{name:"location.region",control:t,render:({field:a})=>e.jsx(g,{label:"Region",required:!0,searchable:!0,data:z.map(o=>({value:o,label:o})),...a,error:r.location?.region?.message})}),e.jsx(i,{name:"location.city",control:t,render:({field:a})=>e.jsx(g,{label:"City",required:!0,searchable:!0,disabled:!m,data:T,...a,error:r.location?.city?.message})})]}),e.jsxs(p,{legend:"Job Details",children:[e.jsx(i,{name:"workArrangement",control:t,render:({field:a})=>e.jsx(g,{label:"Work Arrangement",required:!0,searchable:!0,data:G.map(o=>({value:o,label:o})),...a,error:r.workArrangement?.message})}),e.jsx(i,{name:"isActive",control:t,render:({field:a})=>e.jsx(K,{label:"Listing is active",checked:a.value,onChange:o=>a.onChange(o.currentTarget.checked)})}),e.jsx(c,{label:"Expiration Date",type:"date",...n("expiresAt"),error:r.expiresAt?.message})]})]}),e.jsx(S,{justify:"center",my:10,children:e.jsx(V,{type:"submit",size:"lg",disabled:!q,loading:R,children:"Create"})})]})]})]})}export{$ as CreateListing};
