import{N as q,H as w,r as x,i as f,k,l as T,j as e,t as E,P as N,e as I,F as j,m,d,o as g,p as n,b as l,R as L,W as D,I as J,B as M,n as B,a as F,q as b}from"./index-VHpNQsUs.js";import{S as P,l as W}from"./listing.joi-2be3XD0N.js";function H(){const h=q(),y=w("(max-width: 700px)"),[v,p]=x.useState(!1),{register:o,handleSubmit:A,control:t,formState:{errors:s,isValid:C}}=f({mode:"all",resolver:B(W),defaultValues:{companyName:"",requirements:[],advantages:[],apply:{method:"email",contact:""},location:{region:"",city:""},workArrangement:"",industry:"",isActive:!0,expiresAt:""}}),c=k({control:t,name:"location.region"}),R=x.useMemo(()=>c?T(c).map(a=>({value:a,label:a})):[],[c]),S=async a=>{const r={...a,expiresAt:a.expiresAt?new Date(a.expiresAt).toISOString():null};p(!0);try{(await F.post("/api/listings/",r)).status===201&&(b.show({title:"Success",message:"Listing created!",color:"green"}),h("/my-listings"))}catch(i){b.show({title:"Error",message:`Listing creation failed! ${i?.response?.data||i.message}`,color:"red"})}finally{p(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(E,{title:"Post a Job | JobRocket",description:"Create a new job listing and reach English-speaking candidates in Israel",keywords:"post job, create listing, hire employees, job posting"}),e.jsxs(N,{children:[e.jsx(I,{ta:"center",my:10,children:"Create A Listing"}),e.jsxs("form",{onSubmit:A(S),children:[e.jsxs(j,{direction:"column",gap:10,py:10,mx:"auto",style:{width:y?"90%":"50%"},children:[e.jsxs(m,{legend:"Job Info",children:[e.jsx(d,{label:"Company Name",required:!0,...o("companyName"),error:s.companyName?.message}),e.jsx(d,{label:"Job Title",required:!0,...o("jobTitle"),error:s.jobTitle?.message}),e.jsx(g,{label:"Job Description",minRows:4,required:!0,...o("jobDescription"),error:s.jobDescription?.message}),e.jsx(n,{name:"requirements",control:t,render:({field:a})=>e.jsx(g,{label:"Requirements",placeholder:"Add one requirement per line",minRows:3,value:(a.value||[]).join(`
`),onChange:r=>{const i=r.currentTarget.value.split(`
`).map(u=>u.trim()).filter(Boolean);a.onChange(i)},error:s.requirements?.message})}),e.jsx(n,{name:"advantages",control:t,render:({field:a})=>e.jsx(g,{label:"Nice to Have",placeholder:"Add one advantage per line",minRows:3,value:(a.value||[]).join(`
`),onChange:r=>{const i=r.currentTarget.value.split(`
`).map(u=>u.trim()).filter(Boolean);a.onChange(i)},error:s.advantages?.message})})]}),e.jsxs(m,{legend:"Application",children:[e.jsx(n,{name:"apply.method",control:t,render:({field:a})=>e.jsx(l,{label:"Application Method",required:!0,data:[{value:"email",label:"Email"},{value:"link",label:"External Link"}],...a,error:s.apply?.method?.message})}),e.jsx(d,{label:"Application Contact / URL",required:!0,...o("apply.contact"),error:s.apply?.contact?.message})]}),e.jsxs(m,{legend:"Location",children:[e.jsx(n,{name:"location.region",control:t,render:({field:a})=>e.jsx(l,{label:"Region",required:!0,searchable:!0,data:L.map(r=>({value:r,label:r})),...a,error:s.location?.region?.message})}),e.jsx(n,{name:"location.city",control:t,render:({field:a})=>e.jsx(l,{label:"City",required:!0,searchable:!0,disabled:!c,data:R,...a,error:s.location?.city?.message})})]}),e.jsxs(m,{legend:"Job Details",children:[e.jsx(n,{name:"workArrangement",control:t,render:({field:a})=>e.jsx(l,{label:"Work Arrangement",required:!0,searchable:!0,data:D.map(r=>({value:r,label:r})),...a,error:s.workArrangement?.message})}),e.jsx(n,{name:"industry",control:t,render:({field:a})=>e.jsx(l,{label:"Industry",required:!0,searchable:!0,data:J.map(r=>({value:r,label:r})),...a,error:s.industry?.message})}),e.jsx(n,{name:"isActive",control:t,render:({field:a})=>e.jsx(P,{label:"Listing is active",checked:a.value,onChange:r=>a.onChange(r.currentTarget.checked)})}),e.jsx(d,{label:"Expiration Date",type:"date",...o("expiresAt"),error:s.expiresAt?.message})]})]}),e.jsx(j,{justify:"center",my:10,children:e.jsx(M,{type:"submit",size:"lg",disabled:!C,loading:v,children:"Create"})})]})]})]})}export{H as CreateListing};
